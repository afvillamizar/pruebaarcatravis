language: php
php:
- 5.6
services: postgresql
cache:
directories: $HOME/.composer/cache
before_install:
  - composer self-update --rollback 

install:
  - export PATH="$HOME/.composer/vendor/bin:$PATH"
  - travis_retry composer install $DEFAULT_COMPOSER_FLAGS
  - travis_retry composer global require "fxp/composer-asset-plugin:1.*"
  - travis_retry composer self-update 
  - travis_retry composer update --prefer-dist --no-interaction
before_script:
- psql -c 'CREATE DATABASE integrada_test;' -U postgres
- pg_restore -h localhost -p 5432 -U postgres -d integrada_test -v "common/db_test/Integrada_19092019.backup"
script:
- composer validate --strict
- composer outdated --direct
- composer status --verbose
- cd $TRAVIS_BUILD_DIR/frontend
- ls ../vendor/bin
- ../vendor/bin/codecept run -v